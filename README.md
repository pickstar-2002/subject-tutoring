# 学科辅导：直观讲解定理，引导独立思考

**赛道**: AI 实时交互教育

## 项目简介

本项目是一个基于魔珐星云3D数字人和魔搭社区AI大模型的智能学科辅导系统。通过：

- 🤖 **3D数字人交互** - 实时语音对话，生动的教学体验
- 📚 **多学科支持** - 数学、物理、化学、逻辑等多个学科
- 🎯 **苏格拉底式教学** - 通过提问引导思考，而非直接给出答案
- 📊 **可视化定理展示** - 直观的公式、证明过程和例题展示
- 🧠 **RAG知识库增强** - 基于向量检索的精准知识匹配

## 技术栈

### 前端
- React 18.x + TypeScript
- Vite 5.x
- TailwindCSS
- Zustand (状态管理)
- React Markdown + KaTeX (公式渲染)

### 后端
- Node.js + Express + TypeScript
- 魔搭社区 ModelScope API
- 向量嵌入 (Qwen/Qwen3-Embedding-8B)
- DeepSeek-V3

### 数字人
- 魔珐星云具身驱动 SDK v0.1.0-alpha.45

## 项目结构

```
subject-tutoring/
├── src/
│   ├── client/                    # React 前端
│   │   ├── components/
│   │   │   ├── Avatar/            # 数字人组件
│   │   │   ├── Chat/              # 对话组件
│   │   │   ├── Subject/           # 学科特色组件
│   │   │   └── UI/                # 通用 UI 组件
│   │   ├── store/                 # Zustand 状态管理
│   │   ├── services/              # API 服务
│   │   ├── App.tsx                # 应用入口
│   │   └── main.tsx               # React 挂载
│   ├── server/                    # Express 后端
│   │   ├── routes/                # API 路由
│   │   ├── services/              # 业务服务
│   │   │   ├── ChatService.ts     # 对话处理
│   │   │   ├── RAGService.ts      # 知识库检索
│   │   │   ├── ThinkingService.ts # 思考引导
│   │   │   └── KnowledgeService.ts # 知识库管理
│   │   └── app.ts                 # Express 应用
│   └── shared/                    # 前后端共享
│       ├── types/                 # 类型定义
│       └── constants/             # 常量
├── data/
│   └── knowledge/                 # 知识库数据
├── index.html                    # HTML入口
├── package.json
├── vite.config.ts
├── tsconfig.json
└── .env.example
```

## 快速开始

### 1. 环境准备

- Node.js 18.x 或更高版本
- npm 或 yarn

### 2. 安装依赖

```bash
npm install
```

### 3. 配置环境变量

在应用内点击「设置」按钮，或创建 `.env` 文件：

```bash
# 魔搭社区 API 密钥
MODELSCOPE_API_KEY=your_api_key_here

# 魔珐星云应用密钥
XMOV_APP_ID=your_app_id_here
XMOV_APP_SECRET=your_app_secret_here
```

### 4. 启动开发服务器

```bash
npm run dev
```

访问 http://localhost:5173 查看应用。

## 核心功能

### 1. AI数字人对话

AI 数字人 "学小思" 可以通过自然对话讲解各学科定理：
- 使用苏格拉底式提问引导思考
- 支持流式响应，实时反馈
- 结合知识库提供准确内容
- 一次性说完所有内容，无停顿

### 2. 快捷提问

- 浮动弹出框展示常用问题
- 按学科分类组织（数学、物理、练习、复习等）
- 一键发送，快速开始对话

### 3. 图片题目解析

- 支持上传题目图片
- AI 自动识别题目类型
- 提供详细解题步骤和答案

### 4. 对话体验优化

- 智能自动滚动
- 滚动到底部按钮
- 美观的对话气泡
- 支持多轮对话

### 5. 知识库管理

- 📁 **本地知识库** - 内置数学、物理、化学等学科知识
- 📤 **文档上传** - 支持上传自定义知识文档（TXT、MD、JSON、PDF）
- 🔍 **文档预览** - 查看已上传文档的详细内容
- 🗑️ **文档管理** - 删除不需要的上传文档
- ✨ **自动解析** - 智能解析多种 JSON 格式（问答、知识条目等）

**上传文档格式支持**：
- 纯文本 (.txt)
- Markdown (.md)
- JSON (.json) - 支持问答格式、知识库格式
- PDF (.pdf)

### 6. 用户体验优化

- 🚀 **一键上传** - 选择文件后自动上传，无需二次确认
- 📝 **原始文件名** - 保留用户上传文件的原始名称
- 💬 **气泡确认** - 删除文档时使用优雅的气泡提示替代原生弹窗
- 📄 **格式化展示** - 文档内容保留换行和格式

## AI 提示词

```
你是一位充满耐心、善于引导的学科辅导老师，名为"学小思"。

教学理念：
1. 苏格拉底式教学 - 通过提问引导学生独立思考，而不是直接给出答案
2. 直观讲解 - 用生动形象的比喻和例子帮助理解抽象概念
3. 循序渐进 - 根据学生的理解程度调整讲解深度和节奏
4. 鼓励探索 - 培养学生的好奇心和探索精神

回答风格：
- 使用温暖、鼓励的语气
- 多用提问而非陈述
- 适时给予肯定和鼓励
- 用生活化的例子解释抽象概念

重要原则：
- 一般情况下不要直接给出答案，而是引导学生自己发现
- 当用户上传题目图片请求解析时，请直接给出详细的解题步骤和答案

回复格式约束：
- 禁止使用任何表情符号/emoji和颜文字
- 使用"【】"标记章节标题
- 使用"步骤1、步骤2"标记解题步骤
- 使用**加粗**标记关键词
- 使用$LaTeX$格式书写数学公式
```

### 定理讲解格式模板

```
【定理名称】
公式：$公式内容$
适用条件：列举适用条件

【直观理解】
用生活化例子说明概念的含义

【详细解释】
1. 第一点
2. 第二点

【应用场景】
- 场景一
- 场景二
```

### 题目解析格式模板

```
【题目分析】
- 考查知识点：xxx
- 解题思路：xxx

【解题步骤】
步骤1：xxx
理由：xxx

步骤2：xxx
理由：xxx

【答案】
xxx
```

## API 接口

### 对话接口

#### POST /api/chat/stream
流式对话（SSE）

**请求体**
```json
{
  "message": "请讲解牛顿第一定律"
}
```

**响应** (SSE流)
```
data: {"type":"content","data":"你"}
data: {"type":"content","data":"好"}
data: {"type":"end"}
```

### 知识库接口

#### GET /api/knowledge
查询知识库

**查询参数**
- `category`: 学科分类 (math/physics/chemistry/logic)
- `topic`: 主题
- `difficulty`: 难度 (初级/中级/高级)
- `search`: 搜索关键词

## 部署说明

### 构建生产版本

```bash
npm run build
```

### 环境变量

生产环境需要配置以下环境变量：
- `MODELSCOPE_API_KEY`: 魔搭社区 API 密钥
- `XMOV_APP_ID`: 魔珐星云应用 ID
- `XMOV_APP_SECRET`: 魔珐星云应用密钥

## 界面功能

### 顶部导航
- **设置** ⚙️：配置 API 密钥
- **清空对话**：清除对话历史

### 对话记录区域
- **快捷提问** ⚡：浮动弹出框，选择常用问题
- **滚动到底部**：向上滚动时显示的浮动按钮
- **消息数量**：显示当前消息条数

### 数字人控制
- **连接/断开**：控制数字人连接状态
- **状态指示**：实时显示数字人状态

## 常见问题

### Q: 数字人无法加载？
A: 检查魔珐星云 SDK 配置是否正确，确保 App ID 和 Secret 有效。

### Q: AI 响应很慢？
A: 检查魔搭 API 密钥是否配置，网络连接是否正常。

### Q: 数字人没有声音？
A:
1. 确认数字人已连接（状态显示为绿色）
2. 检查浏览器是否允许音频播放
3. 查看控制台是否有错误信息

### Q: 知识库检索不准确？
A: 可以增加知识库数据，或调整 RAG 检索参数。

## 许可证

MIT

## 致谢

- 魔珐星云 - 3D数字人技术
- 魔搭社区 - AI 大模型服务
- DeepSeek - AI 模型
